<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚ã“ã¡ã‚ƒã‚“ã®ãŠã‚„ã¤ã‚²ãƒ¼ãƒ </title>
<style>
  body {
    margin: 0;
    text-align: center;
    background: #fff8f0;
    font-family: Arial, sans-serif;
  }
  h1 {
    font-size: 40px;
    color: #ff6f91;
  }
  #message {
    font-size: 60px;
    color: gold;
    display: none;
    animation: sparkle 1s infinite;
  }
  @keyframes sparkle {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.7; }
    100% { transform: scale(1); opacity: 1; }
  }
  canvas {
    border: 4px solid #ffb703;
    background: #fff;
  }
</style>
</head>
<body>

<h1>ğŸ° ã‚ã“ã¡ã‚ƒã‚“ã®ãŠã‚„ã¤ã‚²ãƒ¼ãƒ  ğŸ“</h1>
<div id="message">ğŸ‰ ãŠã‚ã§ã¨ã†ï¼ ğŸ‰</div>

<script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
<script>
const { Engine, Render, World, Bodies, Events } = Matter;

const engine = Engine.create();
engine.world.gravity.y = 0.4;

const render = Render.create({
  element: document.body,
  engine: engine,
  options: {
    width: 400,
    height: 600,
    wireframes: false
  }
});

const ground = Bodies.rectangle(200, 590, 400, 20, { isStatic: true });
World.add(engine.world, ground);

const snacks = [
  { radius: 18, color: "#ff4d4d" },
  { radius: 22, color: "#5f6caf" },
  { radius: 26, color: "#ffffff" },
  { radius: 32, color: "#c68642" },
  { radius: 40, color: "#ffe066" }
];

function createSnack(x, level = 0) {
  const snack = Bodies.circle(x, 40, 30, {
    label: "snack",
    level: level
    render:{
      sprite:{
        texture: snackImage[level],
        xScale: 0.3,
        yScale: 0.3
      }
  }

  });
  return snack;
}

document.addEventListener("click", e => {
  const rect = render.canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  World.add(engine.world, createSnack(x));
});

Events.on(engine, "collisionStart", event => {
  event.pairs.forEach(pair => {
    const a = pair.bodyA;
    const b = pair.bodyB;

    if (a.label === "snack" && b.label === "snack" && a.level === b.level) {
      if (a.level === snacks.length - 1) return;

      World.remove(engine.world, [a, b]);

      const next = createSnack(
        (a.position.x + b.position.x) / 2,
        a.level + 1
      );
      World.add(engine.world, next);

      if (next.level === snacks.length - 1) {
        document.getElementById("message").style.display = "block";
      }
    }
  });
});

Engine.run(engine);
Render.run(render);
</script>

</body>
</html>
